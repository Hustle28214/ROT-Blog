import WordCount from '../../../src/components/WordCount/WordCount';

<WordCount>


## 9.1 机器人视觉概述

### 9.1.1 视觉系统

机器人视觉是利用摄像机等成像仪器获取被测物的形状或图像信息，利用计算机、嵌入式系统等完成图像处理，将有效数据进行辨识，形成机器人运动指令的技术。

- 计算机视觉（通用算法研究）：更侧重于研究如何从图像中提取信息并且理解感知它们。
- 机器视觉（工业领域应用）: 机器视觉偏重于技术工程化，能够自动获取和分析特定的图像，以控制相应的行为。
- 机器人视觉（机器人场景理解与交互中提供系统化的关于数据和算法的解决方案）:不仅要考虑如何捕获输入视觉信息，而且还要对这些信息进行处理分析，进而提取出有用的信息给机器人。更强调将机器人运动学，机器人动力学、坐标转换等技术纳入到其技术和算法中。

视觉系统基本组成：

1. 视觉采集系统（照明、镜头、摄像机、通信接口）
2. 图像处理系统（工控主机、视觉处理软件，图形交互界面，等等）
3. 其它外部设备（电传单元、机械单元、机器人本体）

#### 功能与应用

- 传感：即在任何条件下可感知外部的工作环境信息或者其感兴趣目标的信息，记录这些信息作为决策依据。
- 理解：机器人仅仅具备感知能力是不足的，还需要具备对获取的信息进行解析的能力，将其解读为机器人语言，即识别、判断能力。例如，通过感知环境信息，可进行地图构建或者识别障碍物；通过目标感知，能够识别操作目标物体的位置，形状，运动状态、身份等，以此作为后续轨迹规划提供决策基础；
- 行动：机器人可根据获取信息执行相对应的任务或动作；
- 学习：外部的世界是非结构化、动态的，因此需要通过不断地学习来提高自身，以适应环境。

#### 分类

按图像传感器数量区分：

- 单目视觉：只有一个图像传感器，如摄像头。
- 双目视觉：有两个图像传感器，如双目摄像头。
- 多目视觉：有多个图像传感器，如多目摄像头。
- 混合视觉

按图像信息分类：

- 二维视觉系统：普通相机，视觉特征，平面信息
- 三维立体视觉系统：单眼观测法、被动双目立体视觉法、主动光学三角测距、激光雷达测距、结构光法测距等

其它：

- 根据视觉伺服控制中，摄像头是固定在手部还是固定位置，视觉系统可分为眼在手**eye-in-hand**和眼看手**eye-to-hand**两种视觉系统。

- 根据观察者是否主动调整观测场景或者自身的参数来提高感知结果的质量（视觉系统还可以分为**被动和主动视觉**两种形式）。

- 根据镜头不同，分为**全景视觉**系统，**普通视觉**系统。

- 根据应用区分，分为**导航视觉**系统、**抓取视觉**系统、**定位视觉**系统、**跟踪视觉**系统等等。

#### 案例

1. 基于机器人视觉的果蔬采摘机器人目标定位和分类


2. 基于机器人视觉的机械臂视觉伺服跟踪


3. 基于全景机器人视觉的足球比赛机器人定位

机器人足球比赛，全自主形式，采集并处理场地环境的图像，目标识别和机器人自定位，其它机器人的位置、球的位置等信息，以供建立和维护环境模型并提交机器人决策系统进行运动规划和策略生成。


:::warning
请设计一套基于全景机器人视觉的足球比赛机器人定位方案。
:::

<details>
<summary>解析</summary>

方案一：由全向反射镜与摄像机联合使用构建全向视觉系统。

方案二：由组合反射镜面和摄像机组成


</details>

### 9.1.2 视觉传感器

1. 图像传感器
- 主要作用：将光子转换成电子，是视觉传感器的核心部分。
- 主要类型：**CCD**和**CMOS**，两者的主要区别是从芯片中读出数据的方式不同。
2. 视觉传感器
- 主要作用：将图像采集功能和计算机处理能力相结合，能够执行检测，测量等任务。
- 使用方式：视觉传感器通常无需编程，通过视觉软件界面完成配置。

#### CCD VS CMOS

## 9.2 视觉算法与图像处理

### 9.2.1 数据结构

数字图像：把连续的模拟图像在坐标空间和性质空间都离散化了的图像，数字图像可以简单地看作一个二维数组，每一个元素具有坐标$(r,c)$，幅值$g(r,c)$。

一般来说，如果用$b$位来表示像素的灰度值，一个单通道图像可以视为某个函数$f:R \rightarrow G_b$。$R=\{1,2,...,h\} \times \{1,2,...,w\}$是离散二维平面的一个矩形子集，$G_b = \{0,1,...,2^b-1\}$是灰度值集合。

将模拟图像转化为数字图像的过程。对连续图像空间进行离散化处理，每个采样点称为像素。每个采样点上的反射光强的值，称为该像素的灰度值。


### 9.2.2 灰度值变换

一种图像增强的手段，目的是通过调整图像的灰度值来提高**对比度**。

灰度值变换的两种主要方式：**灰度值线性变换**，**灰度直方图均衡化**。

- （1）灰度值线性变换：一种点变换，变换后的灰度值仅仅依赖于输入图像上同一位置的原始值         。 
- （2）灰度直方图均衡化：统计灰度值在图像中出现的频率，通过累积直方图进行灰度值映射的方法。

:::warning
假设一幅大小为$64\times64$的图像，灰度等级为8，灰度值分布如下所示，对图像进行灰度直方图均衡化。

:::
<details>
<summary>解析</summary>
</details>


### 9.2.3 图像平滑

每幅图像都包含某种程度的噪声。噪声是叠加在灰度值上的随机变量。一般把噪声看作平稳随机过程，即对每个像素都是同分布。平滑的目的是减少和抑制图像噪声。

**图像平滑**（空间域增强）是基于图像中的每一个范围(邻域)内的像素进行灰度变换运算，某个点变换之后的灰度由该点邻域内的点的灰度值共同决定。

假设像素灰度值为$g_{r,c}$，$n_{r,c}$为叠加在每个像素值上均值为0，方差为$\sigma^2$的随机变量，则实际的灰度值表示为:

$$
\hat{g_{r,c}} = g_{r,c} + n_{r,c}
$$

#### 均值滤波

由概率论的知识可以知道，经过平均以后噪声的方差降低到原来的$1/n$，标准差相应地降低到原来的$1/\sqrt{n}$。

假设随机过程是遍历的，那么空间均值可以通过像素数是$(2n+1)(2m+1)$的一个窗口（或掩码）按如下方法计算：

$$
g_{r,c} = \frac{1}{(2n+1)(2m+1)}\sum_{i=-n}^{n}\sum_{j=-m}^{m}g_{r+i,c+j}
$$

对于图像来说，均值滤波器可表示为 
$$
h_{r,c} = \begin{cases} \frac{1}{(2n+1)(2m+1)} & |r|<= n ∩ |c|<= m \\ 0 & others \end{cases}
$$

#### 邻域平均法

滤波的思想和计算机视觉中的卷积模板的思想类似，都涉及窗口运算。所谓卷积是用一个卷积核和图像中对应位置做卷积运算，而滤波就是在在窗口内做相应的操作达到去除图像噪声的目的。

### 高斯滤波

在所有平滑滤波器中，高斯滤波器是最理想的平滑滤波器。

### 中值滤波

虽然均值滤波器对噪声有抑制作用，但同时会使图像变得模糊。即使是加权均值滤波，改善的效果也是有限的。中值滤波是一种非线性平滑方法，可以减少边缘的模糊。

$$
g_{r,c} = median\{g_{r-i,c-j}\}
$$

**中值滤波算法举例**

将模板区域内的像素排序，求出中间值。例如：3x3的模板，第5大的是中值，对于同值像素，连续排列。

如$(10,15,20,20,20,20,20,25,100)$。

中值滤波可理解为用一个窗口在图像上扫描，把窗口内包含的象素灰度按照升或降序排列，取灰度值居中的象素灰度代替窗口中心象素的灰度的过程

:::warning
如图所示是中值滤波原理示意图，你知道下次窗口扫描中心像素120，中值滤波后的像素值是多少吗？


:::

</WordCount>