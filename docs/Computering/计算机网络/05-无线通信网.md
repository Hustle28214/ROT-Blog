## 5.1 移动通信和5G

无线通信网包括了面向语音通信的移动电话系统以及面向数据传输的无线局域网和无线广域网。
### 蜂窝通信系统

从1G到3G，移动通信都是针对话音通信设计的，只有未来的4G才可能和Internet无缝地集成。

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/817dd18b5f0191b36a7b83ebaf05a523.png#pic_center)
何谓蜂窝通信？在上图中，蜂窝通信系统的每一个格子周围都分布着不同频段的信道。这样做可以复用频率，大大减少信道间干扰。

### 移动通信制式

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/16f1fa0489d5de86fb80c775b485618d.png#pic_center)
#### 2G时代

我国最初采用欧洲电信的GSM（Global System for Module）和美国高通公司的码分多址（CDMA）系统。从1G到3G，我们都主要使用蜂窝移动网络。

##### 1.全球移动通信系统GSM

GSM系统工作在900-1800MHz频段，无线接口采用TDMA技术，提供话音和数据服务。下图是900MHz的GSM系统的频带利用情况：

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/95c72f66aa20c5c5a4dafd79b4628ca6.png#pic_center)
每一行表示一个带宽为200kHz单工信道，GSM系统中有124对。每个信道采用TDMA技术，支持8个用户会话，则在一个蜂窝小区中同时通话的用户数为$124\times8=992$。


##### 2.码分多址技术（CDMA）

美国高通公司的2G系统工作在800MHz频段，采用CDMA技术，频率利用率高，同样的频率可以提供更多的话音信道，通话质量和保密性好。

码分多址（Code Division Multiple Access,CDMA）是一种扩频多址数字通信技术。在CDMA系统中，对不同的用户分配了不同的码片序列，使得彼此互不干扰。

用户得到的码片序列由+1和-1组成，每个序列与本身进行点积得到+1，与补码进行点积得到-1，一个码片序列和不同的码片序列点积将得到0（正交性）。

例如：

$C_{A1}=(-1,-1,-1,-1)$（用户A）
$C_{A0}=(+1,+1,+1,+1)$（A补码）

$C_{B1}=(+1,-1,+1,-1)$（用户B）
$C_{B0}=(-1,+1,-1,+1)$（B补码）

计算点积如下：

$C_{A1}\cdot C_{A1}=(-1,-1,-1,-1)\cdot(-1,-1,-1,-1)/4=+1$

$C_{A1}\cdot C_{A0}=(-1,-1,-1,-1)\cdot(+1,+1,+1,+1)/4=-1$

$C_{A1}\cdot C_{B1}=(-1,-1,-1,-1)\cdot(+1,-1,+1,-1)/4=0$

$C_{A1}\cdot C_{B0}=(-1,-1,-1,-1)\cdot(-1,+1,-1,+1)/4=0$


从频域或时域来观察，多个CDMA信号互相重叠。接收器在多个CDMA信号中选出预定的码型信号，其他不同码型的信号因为和接收机码型不同而不能被解调，它们的存在类似于信道中存在的噪声和干扰信号，通常称为多址干扰。

在CDMA蜂窝通信系统中，使用频分双工（FDD）技术。不同的码型是根本区分手段。


#### 3G时代

3G标准分为5个标准，分别是IMT-DS、IMT-MC、IMC-TC、IMC-SC、IMT-FT、IMT-2000 OFDMA TDD WMAN。它们分别代表W-CDMA（频分双工）、CDMA-2000（频分双工）、TS-SCDMA（时分双工）、EDGE（2.75G技术）、DECT和WiMAX（无线城域网技术）。

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/fee96370ece5a7a27f48455dc60bc455.png#pic_center)

#### 5G时代

##### 5G应用场景和关键技术

5G关键技术：超密集异构无线网络、大规模输入输出（MIMO）、毫米波通信、软件定义网络和网络功能虚拟化。

采用网络切片技术，将5G网络分割成多张虚拟网络，每个虚拟网络的接入、传输和核心网是逻辑独立的，任何一个虚拟网络发生故障都不会影响到其他网络。
![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/5504a71349036d2a283dacd15894efad.png#pic_center)

## 5.2 无线局域网

### WLAN基本概念

早期WLAN主要有如图4种标准。
![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/ebfa4e36fe4d4416690a4dd888c059ea.png#pic_center)
IEEE 802.11定义了两种无线网络结构，一种是基础设施网络（Infrastructure Networking），另一种是特殊网络（Ad Hoc Networking）。

在基础设施网络中，无线终端通过接入点（Access Point，AP）访问骨干网设备。接入点如同一个网桥，负责在802.11和802.3 MAC协议之间进行转换。一个接入点覆盖的区域称为一个基本服务区（Basic Service Area，BSA），接入点控制的所有终端组成一个基本服务集（Basic Service Set，BSS）。多个BSS相互连接，形成分布式系统（Distributed System，DS）。DS支持的所有服务叫做扩展服务集（Extended Service Set，ESS），由两个以上的BSS组成。

Ad Hoc是一种点对点连接，不需要有线网络和接入点的支持，终端设备之间通过无线网卡可以直接通信。适合在移动情况下快速部署网络。

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/65b103be95298f7478032fe448f66314.png#pic_center)

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/0f3d8185cd176f7c049a5f6e3c4234bb.png#pic_center)

### WLAN通信技术


无线网主要使用三种通信技术：红外线、扩展频谱（扩频）和窄带微波技术。

ISM频段：主要开放给工业、科学、医学机构使用，由美国的FCC所定义，无使用授权限制。

工业频段：902-908MHz

科学频段：2.4-2.4835GHz

医疗频段：5.72505.875GHz
#### 1.红外通信

红外线（Infrared Ray，IR）通信技术可以用来建立WLAN。IR通信相对于无线电微波通信有一些重要的优点：
1. 红外线频谱在世界范围内都不受管制，而有些微波频谱则需要申请许可证。
2. 红外线频率无限，有可能提供极高的数据速率。
3. 红外线可以被浅色的漫反射，可以用天花板反射来覆盖整间房间。
4. 红外线不会穿墙，IR通信不易入侵，网络可互不干扰的工作。
5. 设备简单而且便宜，只需检测光信号的强弱。

缺点：
1. 红外线网络布网中，室内环境可能因阳光或照明而产生相当强的光线，成为红外接收器的噪音，必须用更高能量的发送器，限制了通信范围。
2. 消耗过多的电能
3. 对眼睛造成不良影响


IR通信分为3种技术：定向红外光束（点对点链路）、全方向广播红外线（包含一个基站）、漫反射红外线（线性编码）。


漫反射WLAN采用线性编码的基带传输模式。基带脉冲调制技术一般分为脉冲幅度调制（PAM）、脉冲位置调制（PPM）和脉冲宽度调制（PDM）。

PPM技术的一种应用如图所示。数据1和0都用3个窄脉冲表示，1被编码在位的起始位置，而0被编码在中间位置。使用窄脉冲有利于减少发送的功率，但是增加了带宽。

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/f5e4ddbbbb58024a06ba8622e2b0549c.png#pic_center)

#### 2.扩展频谱通信

扩展频谱通信是将信号散步到更宽的带宽上以减少发送阻塞和干扰的机会。

早期的扩频方式是频率跳动扩展频谱（Frequency-Hopping Spread Spectrum，FHSS），更新的版本是直接序列扩展频谱（Direct Sequence Spread Spectrum，DHSS）。FHSS的典型应用是蓝牙，DHSS的典型应用是Wi-Fi。

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/c08d22a753ddc5230f58d9560b47f344.png#pic_center)

输入数据首先进入信道编码器，产生一个接近某中央频谱的较窄带宽的模拟信号，再用一个伪随机序列对其进行调制。调制结果是大大扩宽了信号的带宽。接收端使用同样的伪随机序列恢复原来的信号，再进行解码。

伪随机序列由一个使用初值（种子Seed）的算法产生，算法是确定的，因此产生的数字序列并不是统计随机的。但除非用户知道算法和种子，否则预测序列是不可能的。
##### 频率跳动扩频

这种扩频方案中，每一个分组都采用不同的频率传输。在所谓的快跳频系统中，每一跳只传送很短的分组。由于军用的快跳频系统中，传输一位信息要用到很多位，接收器与发送同步跳动，因而可以正确地接收信息。监听的入侵者只能收到一些无法理解的信号，干扰信号也只能破坏一部分传输的信息。


![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/b23a764a3ce88c1cb826b8d3acae6c05.png#pic_center)

10个分组分别用$f_3、f_4、f_6、f_2、f_1、f_4、f_8、f_2、f_9、f_3$共9个不同的频点发送。

IEEE 802.11标准规定每一跳的最长时间为400ms，分组最大长度为30ms。FHSS使用的频点间隔为1MHz，如果一个频点由于信号衰落而传输出错，400ms后以不同频率重发的数据将会成功地传送。


##### 直接序列扩频

在这种扩频方案中，信号源中的每一位用称为码片的N个位来传输，在扩展器中进行，码片用传统的数字调制器发送出去。数字系统的带宽与其采用的脉冲信号的持续时间成反比。在DSSS系统中，由于发射的码片只占数据位的1/N，所以DSSS信号的带宽是原来数据带宽的的N倍。

好的随机码相关函数具有非常高的尖峰/旁瓣比。


![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/64ac3e10ed243962bfa8622027b608da.png#pic_center)

在一个具体例子中，直接序列扩展频谱技术是将信息流和伪随机位流相异或。如果信息位是1，它把伪随机码置反后传输；如果信息位是0则不变。经过异或的码与原来的伪随机码有相同的频谱，故具有更宽的带宽。

如下图，每位鼠鼠数据将变成4位信号位。

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/ea02632cb5590a871ac1f2bbfb8bc18d.png#pic_center)
频谱越高，潜在的带宽也越大，但价格也更贵。有些设备运行在2.4GHz（各国共同的ISM频段）上，典型例子如微波炉。

#### 3.窄带微波通信

窄带微波（Narrowband Microwave）是指使用微波无线电频带（RF）进行数据传输，其带宽刚好能容纳传输信号。

下列是两种ISM频带内的窄带微波无线网产品：


1. 申请许可证的窄带RF。这种RF需要通过许可证进行协调，传输声音、数据和视频，确保不会相互干扰。美国的联邦通信委员会（FCC）管理该种许可证、
2. 免许可证的窄带RF。1995年，Radio LAN成为第一个引进免许可证ISM窄带无线网的制造商。可以樱桃园低功率（≤0.5W）的窄带传输。Radio LAN产品的数据速率为10Mbps，使用5.8GHz频带，有效覆盖范围为150-300英尺。Radio LAN的产品根据参数自动选择一个终端作为动态主管，类似于集线器。同时支持动态中继。


### IEEE 802.11体系结构

802.11WLAN的协议栈如图。

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/79d9d77479243e3a19c25d86875adb3d.png#pic_center)

#### 1.物理层

IEEE 802.11定义了3种PLCP帧格式来对应3种不同的PMD子层通信技术。

##### FHSS

FHSS(Frequency-Hopping Spread Spectrum)，即跳频技术。

SYNC是0和1的序列，共80位作为同步信号。SFD的位模式为0000110010111101，用作帧的起始符。PLW代表帧长度，共12位，帧最大长度可以达到4096字节。PSF是分组信令字段，用来标识不同的数据速率。起始数据速率为1Mbps，以0.5的步长递增。PSF=0000时代表数据速率为1Mbps；PSF=0010时，即$1Mbps+0.5Mbps\times2=2Mbps$；PSF=1111，则$1Mbps+0.5Mbps\times15=8.5Mbps$。16位的CRC是为了保护PLCP头部所加的，能纠正2位错。MPDU代表MAC协议数据单元。


![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/4fa4ed9559a47b87df4e51921dd8a027.png#pic_center)
PMD层可以采用以下3种跳频模式之一，每种跳频模式在26个频点上跳跃：

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/1f6e25a873214e39312fc1b7ff3f126a.png#pic_center)

具体采用哪种跳频模式由PHY管理子层决定。3种跳频点可以提供3个BSS在同一小区中共存。IEEE 802.11规定，跳跃速率为2.5跳/秒，推荐的发送功率为100mW。


##### DSSS

扩展频谱（Spread Spectrum）技术是一种常用的无线通讯技术，简称展频技术。SFD的位模式为1111001110100000。Signal字段表示数据速率，步长为100kbps，比FHSS精确5倍。如Signal字段=00001010时，$10\times100kbps=1Mbps$，$20\times100kbps=2Mbps$。Service字段保留未用。Length字段指MPDU的长度，单位为μs。

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/5d798c64d0a0dfdc148b30bff2cf278e.png#pic_center)

IEEE 802.11采用的直接系列扩频信号，每个数据位被编码为11位的Barker码，图中采用的序列为[1,1,1,-1,-1,-1,1,-1,-1,1,-1]。码片速率为11Mb/s，占用的带宽为26MHz，数据速率为1Mbps和2Mbps时分别采用差分二进制相移键控（DB/SK）和差分四相相移键控（DQPSK），即一个码元分别代表1位或2位数据。

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/83ceb291c81bc0d5632214b9b02972bd.png#pic_center)

ISM的2.4GHz频段划为11个相互覆盖的信道，其中心频率间隔为5MHz，接入点AP可根据干扰信号的分布在5个频段中选择一个最有利的频段，推荐发送功率为1mW。

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/b082bc1710e5ad853195cd93064e6f6d.png#pic_center)
不重叠信道：2.4GHz频段，13个信道中含3个不重叠信道（1、6和11）；5G+5.8G频段，开放的不重叠信道有5个。

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/4abea6f8d78378ba76b6b36dc4e9f2b1.png#pic_center)

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/a42a0362d319e0e83d71e98772230258.png#pic_center)

##### DFIR

漫反射红外线（Diffused IR，DFIR），其SYNC短于FHSS和DSSS，因为采用光敏二极管检测信号不需要复杂的同步过程。Data rate字段=000，表示1Mbps；Data rate字段=001，表示2Mbps。DCLA是直流电平调节字段，通过发送32个时隙的脉冲序列来确定接收信号的电平。MPDU的长度不超过2500字节。

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/27d549e42a6830e94305c0cd7220a012.png#pic_center)


#### 2.MAC子层

MAC子层的功能是提供访问控制机制，并且提供3种：CSMA/CA支持竞争访问，RTS/CTS和点协调功能支持无竞争的访问。

##### CSMA/CA协议

这种访问控制机制称为载波监听多路访问/冲突避免协议。

无线网中，2个站进行冲突检测会有困难，但它们之间的第3个站可能会检测到冲突，即隐蔽终端问题。

采用冲突避免的办法可以解决上述问题。802.11定义了一个帧间隔（Inter Frame Spacing，IFS）时间。另外，还有一个后退计数器，其初始值随机设置，递减计数直到0。

基本操作过程：

1. 一个站需要发送数据并监听到信道繁忙，则产生一个随机数设置自己的后退计数器，坚持监听。
2. 监听得知信道空闲，等待IFS时间后开始计数，最先计数完的站开始发送。
3. 其他站在监听到新的站开始发送后暂停计数，等待其发送完成后再等待一个IFS时间后继续计数，计数完成后发送。

此算法遵循“先到先得，公平竞争”的计算原则。

##### 分布式协调功能

802.11 MAC层定义的分布式协调功能DCF（DistributedCoordinationFunction）机制是节点共享无线信道进行数据传输的基本接入方式，结合了CSMA/CA技术和确认（ACK）技术。在此基础上，又定义了点协调功能（Point Coordination Function，PCF）。DCF是数据传输的基本方式，作用于信道竞争期。PCF工作于非竞争期。

两者经常交替出现，先由DCF竞争介质使用权，然后进入非竞争期，由PCF控制数据传输。


![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/ce2e3dc1b4f2965c7057911a9058ba7b.png#pic_center)

为使各种MAC操作互相配合，IEEE 802.11推荐使用3种帧间隔（IFS），以便提供基于优先级的访问控制。

- DIFS（分布式协调IFS）：最长的IFS，优先级最低，用于异步帧竞争访问的时延。
- PIFS（点协调IFS）：中等长度的IFS，优先级居中，在PCF操作中使用。
- SIFS（短IFS）：最短的IFS，优先级最高，用于需要立即响应的操作。

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/35beebc6e75d76cd003f5f69e1f66852.png#pic_center)
##### 点协调功能

PCF是DCF之上的一个可选功能。

点协调就是由AP集中轮询所有终端，提供无竞争的服务。这种机制适用于时间敏感的操作，在轮询过程中使用PIFS作为帧间隔时间。由于PIFS比DIFS小，所以点协调能够优先CSMA/CA获得信道，并把所有的异步帧都推后传送。

极端情况下，点协调功能可以连续轮询以排除所有的异步帧。为避免如此的浪费，802.11又定义了一个称为超级帧的时间间隔。在此时段的开始部分，由点协调功能向所有配置成轮询的终端发出轮询。随后在超级帧余下的时间允许异步帧竞争信道。

#### 3.MAC管理

MAC管理子层的功能是实现登记过程、ESS漫游、安全管理和电源管理等功能。


WLAN是开放系统，传输介质共享，通信站也是移动的。所以必须解决信息的同步、漫游、保密和节能问题。

##### 1.登记过程

信标是一种管理帧，由AP定期发送，用于时间同步；还可识别AP和网络，包含基站ID、时间戳、睡眠模式和电源管理等信息。

终端在进入WLAN区域时，需要同步搜索以定位AP，获取相关信息。同步可以选择主动扫描和被动扫描。

主动扫描即终端在预定的各个频道上连续扫描，发射探试请求帧，并等待各个AP的响应帧；收到各AP的响应帧后，工作站将比较各个帧的相关部分以确定最佳AP。

被动扫描即终端在BSS区域，可以收到各个AP周期性发射的信标帧，因为帧中含有同步信息，所以工作站在对各帧进行比较后，确定最佳AP。

终端定位了AP获得同步信息后开始认证过程，包括AP对工作站身份的确认和共享密钥的认证等。

认证过程结束后就开始关联过程，关联过程包括终端和AP交换信息，在DS中建立终端和AP的映射关系，DS将根据该映射关系来实现相同BSS和不同BSS间的信息传送。

##### 2.移动方式

IEEE 802.11定义了3种移动方式：

无转移方式：是指终端是固定的，或者仅在BSA内部移动；

BSS转移：是指终端在同一个ESS内部的多个BSS之间移动。

ESS转移：是指从一个ESS移动到另一个ESS。


漫游：当终端开始漫游并逐渐远离AP时，它对AP的接收信号将变坏。这时，终端启动扫描功能重新定位AP，一旦定位了新的AP，工作站随即向新AP发送重新连接请求，新AP将该请求通知分布式系统（DS），DS随即更改该工作站与AP的映射关系，同时通知AP取消关联性。新AP向该终端发射重新连接响应。


##### 3.安全管理

IEEE 802.11规定了认证和加密措施使得无线网络和有线网络拥有同等的安全性能。

认证程序控制WLAN接入的能力，所有无线终端以此来建立合法的身份标志。如果AP和工作站之间无法完成相互认证，那么它们就不能建立有效的连接。IEEE 802.11协议支持多个不同认证过程。



##### 4.电源管理

IEEE 802.11允许空闲站睡眠，并依靠同步时钟周期性唤醒睡眠中的空闲站，由AP发送的信标帧中的TIM（业务指示表）指示是否有数据暂存与AP，如有则向AP发探询帧，并接收AP的数据，然后睡眠。如无，则立刻睡眠。



#### 4.802.11技术标准对比

> 此考点非常重要，属于常考考点！

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/9caf8449e5295641e48b6c55e565167e.png#pic_center)
### 移动Ad Hoc网络


IEEE 802.11标准定义的Ad Hoc网络是由无线移动节点组成的对等网，无需网络基础设施的支持，每个节点既是主机，又是路由器，是一种MANNET（Mobile Ad Hoc Network）网络。

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/ac26eefb1e73a61ab83fcfec00ff0fd5.png#pic_center)


Ad Hoc在拉丁语里有“即兴、临时”的意思。可以一窥，MANET网络的部署是非常敏捷灵活的。

#### MANET网络特点

- 网络拓扑结构动态变化，不能使用传统路由协议。
- 无线信道提供的带宽较小，信号衰落和噪声干扰影响很大。
- 无线终端携带的电源能量有限。
- 容易招致网络窃听、欺骗、拒绝服务等恶意攻击的威胁。

#### MANET 中的路由协议

1. 扁平的路由协议
2. 分层的路由协议
3. 地理信息路由协议

#### DSDV协议

目标排序的距离矢量协议（Destination-Sequenced Distance Vector,DSDV）是一种扁平式路由协议。


![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/8d186714c2e467d0f8d4008fb76904b0.png#pic_center)

图中参数解释如下：


- 路由表（Routing Table）：每个节点在DSDV协议中维护一个路由表，用于存储到达不同目的地的最佳路径和距离信息。

- 目的地序列号（Destination Sequence Number）：它是每个目的地节点维护的一个递增的序列号，用于区分不同的路由更新。
- 有效序号（Valid Sequence Number）：路由表中每个目的地节点都有一个有效序号字段，表示已知的最新的目的地序列号。


- 下一跳（Next Hop）：在DSDV协议中，每个节点通过距离向量算法选择到达目的地的下一跳节点，下一跳节点即为该目的地的下一个路由器。

- 距离（Distance）：节点之间通过跳数或者其他指标来衡量距离。在DSDV协议中，距离一般指跳数，表示到达目的地所需经过的中间节点数。

- 广告（Advertisement）：节点周期性地发送路由更新消息，包含自己的路由表信息，这些消息称为广告。广告周期性地向周围的邻居节点传播，并用于更新邻居节点的路由表。

- 每跳度量（Hop Count）：DSDV协议中的默认度量标准，表示到达目的地所需经过的中间节点数。每跳度量越小，表示路径质量越好。

DSDV节点周期性地广播路由公告。链路断开立刻触发链路公告：一是广播全部路由表项，称为完全更新，开销很大；二是只发送最近改变的路由表项，称为递增式更新。

同时，DSDV分别通过基于序列号值的路由更新策略和平均定制时间策略解决了路由环路现象和路由波动问题。

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/715ae14d4053f467dda837c352a0f641.png#pic_center)

#### AODV协议

无线自组网按需平面距离向量路由协议（Ad hoc On-Demand Distance Vector Routing，AODV）是应用于无线随意网络（也称作无线Ad hoc网络）中进行路由选择的路由协议，它能够实现单播和多播路由。该协议是Ad Hoc网络中按需生成路由方式的典型协议。

(1)AODV属于网络层协议。每次寻找路由时都要触发应用层协议，增加了实现的复杂度。 

(2)IEEE 802．15．4规定的帧大小为127字节，MAC头部及尾部校验最多使用了25字节，IPv6头部与UDP头部占用48字节，只剩下54字节的空余。

(3)LR—WPAN中，拓扑结构相对简单，网络的规模相对较小，节点的位置不固定，对它的设计首先要考虑的因素是简单、节能等问题。AODV的路由框架和报文设计并没有考虑这些问题。

当一个节点需要发现到达某个目标节点的路由时就广播路由请求（Route Request，RREQ）报文。

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/3664cafb9b1fa85810f332a10db6fdcc.png#pic_center)


### IEEE 802.11的新进展

#### WLAN安全机制

无线局域网中，可采取下列安全措施：

- SSID访问控制

各个无线接入点（AP）可设置不同的SSID（Service Set Identifier），SSID由32个字符组成。一般的无线路由器都可设置允许SSID广播，该SSID会被用户搜索到。同一厂商的路由器或AP都使用相同的SSID，为了安全性，一般买到新设备需要修改SSID名字。

- 物理地址过滤

MAC地址过滤的做法是，每个无线网卡都有唯一的MAC地址，可以在无线路由器中维护一组允许访问的MAC地址列表，要求无线路由器的MAC地址列表经常更新。但由于MAC地址可以伪造，所以该认证级别比较低。

- 有线等效保密WEP

有线等效保密（Wired Equivalent Privacy，WEP）能够提供与有线局域网等价的机密性。WEP使用RC4协议进行加密，并使用CRC-32校验。

RC4是一种流加密技术，加密过程是对相同长度的密钥流与报文进行“异或”操作，计算得出密文。密钥流不能重复使用。WEP使用每次不同的初始向量IV（Initialization Vector）与用户指定的固定字符串来生成变化的密钥流。

某些主动式攻击可以激发足够的流量，破获足够多的数据包便可破解出密钥。IV雷同和编造的数据包同样带来安全隐患，即使密钥很长也束手无策。

- WPA

WPA（Wi-FI Protected Access）这种安全认证方案由Wi-FI联盟提出，被广泛地使用。


WPA设计包含了认证、加密和数据完整性校验3个部分。WPA使用802.1x协议对用户的MAC地址进行认证，WEP的RC4加密增大了密钥和初始向量的长度（128位密钥和48位IV）。并且，WPA采用了可动态改变密钥的临时密钥完整性协议TKIP（Temporary Key Integrity Protocol）。WPA放弃了WEP使用的CRC循环冗余校验方法，使用报文完整性编码来检测伪造数据包，并在报文认证码中置有帧计数器，防止重放攻击。

并有按新的标准制定的认证方案WPA2。WPA2的加密协议由RC4变为基于AES的CCMP。

- IEEE 802.11i

IEEE 802.11i包含TKIP、CBC-MAC协议的计时器模式（基于AES设计）、802.1x基于端口的身份认证协议。


可扩展的认证协议EAP（Extensible authentication protocol）是一种认证框架而非方法，直接运行在数据链路层（PPP/IEEE 802）。它包含如下大名鼎鼎的一些认证机制：

- EAP-MD5：要求传送用户名和口令字，并用MD5进行加密，类似于PPP的CHAP协议。它不能抗拒字典攻击，不能提供相互认证和密钥导出机制，很少在无线网中采用。
- Lightweight EAP（LEAP）：Cisco公司的专利协议，是一种轻量级的EAP。它要求用户名和口令字发送到Radius服务器进行处理，被认为不是很安全。
- EAP-TLS：利用传输层安全协议TLS来传送认证报文，用户和服务器都需要X.509证书，这种方法可以提供双向认证（RFC2716）。

除此之外，802.11i还提供了一种任选的加密方案WARP（Wireless Robust Authentication Protocol）。WARP原是为802.11i制定的基于AES的加密协议，后因知识产权纠纷被CCMP替代。故支持CCMP是强制的，但支持WARP任选。


802.11i还实现了一种动态密钥交换和管理体制，用户通过认证后从认证服务器得到一个主密钥MK（Master Key），经一系列推导过程，用户与AP之间会生成一对组瞬时密钥GTK（Group Transient Key）。PTK（Pairwise Transient Key，成对临时密钥）用于保护单播数据。GTK用于保护组播和广播数据。

预共享密钥PSK（Pre-Shared Key）适用于办公室和家庭。PSK有256位，由给定的口令字生成，用于上述密钥管理体制中的主密钥MK。整个网络可以共享一个PSK，也可以每个用户专用一个PSK，更加安全。


#### WLAN的传输速率


- 正交频分复用技术（Orthogonal Frequency Division Multiplexing）是MCM(Multi Carrier Modulation)，多载波调制的一种。其主要思想是将信道划分成若干正交子信道，将高速数据信号转换成并行的低速子数据流，并将各个子数据流交织编码，调制到正交的子信道上进行传输，在接收端采用相关技术可以将正交信号再分开。OFDM可以减少子信道之间的相互干扰，具有较高的频谱利用率。



- 多入多出技术（Multiple Input Multiple Output，MIMO）通过多径无线信道实现，为极大地提高信道容量，在发送端和接收端都使用多根天线，在收发之间构成多个信道。采用这种技术的WLAN可以在室内环境下达到20-40bps/Hz的频谱效率。

除此之外，802.11n还采用了智能天线技术，可以动态调整波束，保证信号稳定；软件无线电技术实现在一个可编程的硬件平台上，不同系统的基站和终端都可以通过不同软件互联互通。



## 5.3 无线个人网

IEEE 802.15负责制定无线个人网（Wireless Personal Area Network，WPAN）的技术。这是一种小范围的无线通信系统，覆盖范围在10m左右。

本节就802.15.1和802.15.4讨论。

### 蓝牙技术


蓝牙的本意是“统一”，这是一个出自丹麦国王“蓝牙王”的典故。2001年，蓝牙1.1版被颁布为802.15.1标准。


#### 1.核心系统体系结构


最下面的Radio层相当于OSI的物理层，其中的RF模块采用2.4GHz的ISM频段实现FHSS通信，信号速率1Mbps，数据速率1Mbps。

多设备共享同一物理信道时，公共时钟同步了各个设备，并调整到同样的跳频模式。其构成一个微微网（piconet），即蓝牙技术的基本组网模式。

物理信道被划分为时槽，数据被封装成分组，每个分组占用一个时槽。一对收发设备间可以用时分多路（TTD）方式实现全双工通信。
![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/68bfa2f2f07094e63f131ff4c13aaea4.png#pic_center)
物理信道之上是各种链路和信道层及其有关的协议。向上一次形成的是物理信道、物理链路、逻辑传输、逻辑链路和L2CAP信道。

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/47db7c61cfed5cf922b0a8228519e183.png#pic_center)
基带层和物理层的控制协议叫做链路管理协议LMP（Link Manager Protocol），用于控制设备的运行，并提供底层设施（PHY和BB）的管理服务。每个处于活动状态的设备都具有一个默认的ACL用于支持LMP信令的传送。默认的ACL是当设备加入微微网时随即产生的。

逻辑链路控制和自适应协议L2CAP是对应用和服务的抽象，对应用数据进行分段和重分配，并实现逻辑链路的复用。它可以提供任选的差错检测和重传功能、基于窗口的流量控制功能。

核心系统只包含4个低层功能及其有关的协议。最下面的3层通常构成了蓝牙控制器。蓝牙控制器和高层之间的接口叫做主机控制器接口HCI（Host Controller Interface）。


#### 核心功能模块


1. 信道管理器
2. L2CAP资源管理器
3. 设备管理器
4. 链路管理器（LM）
5. 基带资源管理器
6. 链路控制器
7. RF

#### 数据传输结构


![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/b329185af33220d12aaa02c17b6be7d7.png#pic_center)


### ZigBee技术

ZigBee是基于IEEE 802.15.4开发的技术标准。这是很容易混淆的区别，然而两者有本质的不同。

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/a8f56d6db16ac30b17c9fe97bfcde271.png#pic_center)
ZigBee 协议属于高级通信协议，是基于上世界的IEEE协会制定的802协议，主要约束了网路的无线协议、通讯协议、安全协议和应用需求等方面的标准，其有效转播速率可以达到300Kbps （千比特率）。 和计算机通信的模式类似，ZigBee的网络协议是分层结构，自下而上主要由五层结构构成，其中包括用户层，ZigBee联盟和 IEEE802.15.4协议。 

Zigbee的结构分为4层：分别是物理层，MAC层，网络/安全层和应用/支持层。 其中应用/支持层与网络/安全层由Zigbee联盟定义，而MAC层和物理层由IEEE802.15.4协议定义，以下为各层在Zigbee结构中的作用：

物理层：作为Zigbee协议结构的最低层，提供了最基础的服务，为上一层MAC层提供了服务，如数据的接口等等。同时也起到了与现实（物理）世界交互的作用；

MAC层：负责不同设备之间无线数据链路的建立，维护， 结束，确认的数据传送和接收；

网络/安全层：保证了数据的传输和完整性，同时可对数据进行加密；

应用/支持层：根据设计目的和需求使多个器件之间进行通信。

