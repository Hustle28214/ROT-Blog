import WordCount from '../../../../../src/components/WordCount/WordCount';
import Mermaid from '@theme/Mermaid';

<WordCount>

## 1. auto关键字

auto用于变量的类型推导，根据初始化表达式的类型来推导变量的类型，常用于简化代码和处理复杂类型。

```cpp
auto a = "hello"; // 自动推导出字符串
auto b = 2; // 自动推导出int
```

在写算子优化求解等问题时，`auto`发挥着非常关键的作用，特别是构建张量，它能在`<static_cast>`满天飞的代码里自动省去很多麻烦。

`auto`的原理类似于模板参数推导。



### 1.1 auto的限制

1. 必须初始化变量
2. 不能用作函数参数
3. 不能用于数组
4. (但可以用于指针)
5. 无法推导出模板参数
6. 

## 2. decltype关键字

```cpp
decltype(entity)       // entity 是一个标识符（变量、函数等）
decltype(expression)   // expression 是任意表达式

int a = 10;
const int& b = a;
decltype(a) x;          // int
decltype(b) y = a;      // const int&（必须初始化）

// 其他类型
int a = 0;
int* p = &a;

decltype(a)     d1;    // int
decltype((a))   d2 = a; // int&，必须初始化
decltype(*p)    d3 = a; // int&（解引用指针产生左值）
decltype(++a)   d4 = a; // int&（前置自增返回左值）
decltype(a++)   d5;     // int（后置自增返回纯右值）
decltype(42)    d6;     // int（字面量是纯右值）
decltype(std::move(a)) d7 = 0; // int&&（std::move(a) 是将亡值）
```

:::info
`decltype`在C++14中可以实现`decltype(auto)`, 用于让变量或返回类型的推导采用 decltype 的规则，而不是 auto 的规则。通常用于转发函数或完美返回。

```cpp
decltype(auto) f1() { return x; }      // 返回类型为 x 的声明类型
decltype(auto) f2() { return (x); }    // 返回类型为 int&（注意括号！）
```
:::

然而如果我们要用auto推导函数的返回类型，会这样写：

```cpp
template<typename X, typename Y, typename Z>
X AddTwoItems(Y y,Z z){
    return y+z;
}
// 以下注释掉的写法是不合法的：
//decltype(y+z) AddTwoItems(Y y,Z z);

```




</WordCount>