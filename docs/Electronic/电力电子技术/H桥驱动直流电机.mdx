import WordCount from '../../../src/components/WordCount/WordCount';

<WordCount>

L298N是我玩的比较多的一个电机驱动模块，它可以驱动直流电机，尤其是电流比较大的情况。今天分享一下它的工作原理。

## 1. H桥电路

L298N是利用H桥电路实现的。首先我们要认识一下什么是H桥电路。

![Image](https://github.com/user-attachments/assets/112c8816-dced-42ac-96bd-cef590ee7138)

图中展示了一个H桥电路的基本结构。它由四个开关，一个电机和四个续流二极管组成，整体比较像“H”字母，故名H桥电路，也称为“全桥电路”。

## 2. 工作原理

这里列举四个最常见的工作模式：正转，反转，PWM调速,制动。

### 2.1 正转


H桥一般用来驱动感性负载。

正转的时候，电流会经过Q1,电机，Q4。如下图：

![Image](https://github.com/user-attachments/assets/00afe046-6aba-48ce-95e4-3767fc61e4a1)

此时，电机获得电压 ≈ VBAT（忽略 M1、M4 的导通压降）,电机加速，直到反电动势 BEMF 与外加电压平衡（减去绕组电阻压降），稳态电流由负载决定。

两对二极管D1、D4，在当前状态（M1、M4导通）下，D1、D4 被短路，不发挥作用。D2、D3 反向偏置，不导通。

讨论关断情况。假设 M1、M4 同时关断：电机电感电流原方向：M1 → 电机 → M4 → 地，关断瞬间，电流不能立即变零，需经过续流回路：电机左端 → D2 → VBAT 正端 → VBAT 负端（地） → D3 → 电机右端这样电流通过 D2、D3 形成回路，能量回馈到电源（若电源可吸收）或消耗在电源电容及电阻中。电压被钳位在 VBAT（因为 D2 阳极接电机左端，阴极接 VBAT+；D3 阴极接电机右端，阳极接地），所以电机两端电压 ≈ -VBAT（右正左负），这是典型的**反向电压制动**在 PWM 关断时的表现。

### 2.2 反转

反转，电流会经过Q3，电机，Q2。如下图：

![Image](https://github.com/user-attachments/assets/1024a07e-e93a-4283-9e24-52d6a416475e)

MOS管的开关刚好和正转相反。电路现象类比正转。

### 2.3 PWM调速

调速，电路情况类似下图。我们只讨论Q1 ON/Q4 输入PWM信号/Q2 Q3关断的情况.

![image](https://github.com/user-attachments/assets/c83b353a-1429-411d-932c-ea7d7cae6154)

说白了,就是通过调整占空比控制Q4开关时间,从而达到PWM调速的目的.

### 2.4 制动

制动,假设电机从正转变为停止.

此时,关断Q1和Q4,直流电机可等效为电感,电流不会马上衰减,电流仍然会通过反向续流二极管进行流动.这就是为什么用L298N的时候只拔对应线管是没用的.

这里有两个常用的方法,可以衰减电路电流:

1. 关断Q1 Q4,开启Q2和Q3.

![Image](https://github.com/user-attachments/assets/b1ecd60f-5b72-4c2a-8254-1e8154e55cbe)


2. 准备停止时,关断Q1,打开Q2,形成Q2 Q4 电机 地线之间的环路.此时电流不会快速衰减,但会被MOSFET中的内阻缓慢消耗掉.所以适合缓慢停止.

![Image](https://github.com/user-attachments/assets/5aa9662b-d85c-406a-a910-44d9a7b18971)





</WordCount>